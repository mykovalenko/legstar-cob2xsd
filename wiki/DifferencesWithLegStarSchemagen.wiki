#summary Differences from legstar-schemagen.
#labels Phase-Requirements,Featured

This document is targetted at current [http://www.legsem.com/legstar/legstar-schemagen/index.html legstar-schemagen] users. legstar-schemagen is the [http://www.legsem.com/legstar LegStar] module in charge of translating COBOL structures to XML Schema.

legstar-cob2xsd also translates COBOL structures to XML Schema. It has several options that ensure XML schema produced are compatible with LegStar 1.2.6 and eventually, legstar-cob2xsd will replace legstar-schemagen.

legstar-cob2xsd is a standalone utility. The intent is that it stays independent from the rest of LegStar.

The most obvious difference with legstar-schemagen is that legstar-cob2xsd is written entirely in Java. legstar-schemagen was mostly C. This simplifies 

A more subtle difference is that legstar-cob2xsd uses [http://www.antlr.org/ ANTLR] grammars to parse COBOL structures while legstar-schemagen was handcoded. The XML Schema produced is generated using [http://ws.apache.org/commons/XmlSchema/ Apache XmlSchema].

The XMl Schema produced will often look different from the one legstar-schemagen generates. This is a list of differences:

 * No more xs: prefix for XML Schema elements, XML Schema is the default namespace.

 * By default, Element names start with a lowercase character (Complex Type names start with uppercase). However, a [http://www.legsem.com/legstar/legstar-cob2xsd/apidocs/com/legstar/cob2xsd/Cob2XsdContext.html#setElementNamesStartWithUppercase(boolean) backward compatibility setElementNamesStartWithUppercase option] exist to restore a legstar-schemagen bahavior.
 
 * Bydefault, Complex Type name conflicts are resolved like with legstar-schemagen, by appending COBOL file source line. But there is a new option to prepend the parent Complex Type name instead. Relevantt option is [http://www.legsem.com/legstar/legstar-cob2xsd/apidocs/com/legstar/cob2xsd/Cob2XsdContext.html#setNameConflictPrependParentName(boolean) setNameConflictPrependParentName].

 * Most numeric items have a totalDigits facet now. Previously, only decimals with fractionDigits had totalDigits. Only unsignedLong still have maxInclusive instead of totalDigits because of a bug in JAXB XJC (715).

 * Most numerics don't have a maxInclusive facet anymore (they were serving the purpose of totalDigits). Only exception is unsignedLong.

 * Most numerics don't have a minInclusive facet anymore. Exceptions are xsd:integer and xsd:decimal when they are unsigned. In these cases, minInclusive is used to enforce the positive character of the numeric. For decimals, the minInclusive value is not "0.0" anymore but simply "0".

 * xsd:string and xsd:hexBinary now use the maxLength facet instead of the length. There is no reason to force a fixed length since the COBOL binder is perfectly capable of filling the void.

 * level 88 are mapped to XML schema enumeration facets or minInclusive/maxInclusive. This is turned off by default because COBOL level 88 are not restrictions on the content. Relevant option is [http://www.legsem.com/legstar/legstar-cob2xsd/apidocs/com/legstar/cob2xsd/Cob2XsdContext.html#setMapConditionsToFacets(boolean) setMapConditionsToFacets].

 * minOccurs and maxOccurs are now omitted when they have the default value 1. 

 * LegStar annotations are not generated by default. To get the annotations, you need to turn on the [http://www.legsem.com/legstar/legstar-cob2xsd/apidocs/com/legstar/cob2xsd/Cob2XsdContext.html#setAddLegStarAnnotations(boolean) setAddLegStarAnnotations option].

 * For LegStar annotations, attribute usage='DISPLAY' is now omitted, unless explicit in the COBOL source.

 * For LegStar annotations, attribute levelNumber does not have leading zeroes anymore: levelNumber="05" becomes levelNumber="5".

 * For LegStar annotations, srceLine attribute is sometimes different because legstar-schemagen used the last clause line while legstar-cob2xsd uses the line on which the clause starts.

 * For LegStar annotations, cobolName attribute is FILLER if the data item is a filler. legstar-schemagen used FILLER-srcLine instead.

 * The default COBOL compiler QUOTE option is now QUOTE (it is APOST for legstar-schemagen). You can revert this setting option [http://www.legsem.com/legstar/legstar-cob2xsd/apidocs/com/legstar/cob2xsd/Cob2XsdContext.html#setQuoteIsQuote(boolean) setQuoteIsQuote] to false.



